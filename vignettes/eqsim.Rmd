---
title: "Using the msy package"
author: "John Simmond, Colin Millar and Einar Hjörleifsson"
date: '`r Sys.Date()`'
output: html_document
vignette: >
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEngine{knitr::rmarkdown}
  \usepackage[utf8]{inputenc}
---

# Preamble

This document is as much as the msy-package itself still in developement.

The origin of this package is from an intial coding by John Simmonds which was restructured by Colin Millar into an R-package with additional development, including coding the Buckland method. Einar Hjörleifsson compartmentalized the structure of the code as well as providing the output of the analysis in a more structured format.

At this moment there is no person responsible for the maintainance of the package, including the above mentioned names.

# Installation

The developmental repository for the `msy` package is located on [github](https://github.com), more specifically on [github.com/wgmg/msy](https://github.com/wgmg/msy)


The easiest way to install the `msy` package is to use the function `install_github` in the `devtools` package. Since the input into the msy is in the form of a `FLStock` object it is advised to obtain the latest release of `FLCore` from the same site.

The [`Rtools.exe`](http://cran.at.r-project.org/bin/windows/Rtools) software is needed for building packages under Microsoft Windows. 

Run the following lines to install the latest versions of `msy` and `FLCore`.

```{r install, eval=FALSE}
# install.packages("devtools")
library(devtools)
install_github("wgmg/msy")
install_github("flr/FLCore")
```

The above is equivalent to `install.packages` and hence need only to be performed once. However, since the `msy` package is currently under development (including bug-fixing) one may expect more frequent code updating in the package than what one may be familiar with for packages on `CRAN`. Once installed the `msy` packages is simply loaded via the familiar:

```{r loadLibrary, message=FALSE}
library(msy)
```

Besides functions the package comes with the following data:

* codCS: `FLStock` object of the Celtic Sea cod
* codEB: `FLStock` object of the Eastern Baltic cod
* codIS: `FLStock` object of the Icelandic cod
* codNS: `FLStock` object of the North Sea cod
* codWB: `FLStock` object of the Western Baltic cod
* codWS: `FLStock` object of the West of Scotland cod
* saiFO: `FLStock` object of the Faroe saithe
* saiIS: `FLStock` object of the Icelandic saithe
* solKA: `FLStock` object of the Kattegat sole

These are all stored in the icesStocks list object.

The current version of the `msy` implements two methods that go under the working names EqSim and plotMSY. Only usage of functions for the EqSim approaches are described in the following sections.

# Minimum code

```{r}
FIT <- eqsr_fit(icesStocks$codNS,
                nsamp = 500, 
                models = c("ricker", "segreg", "bevholt"))
eqsr_plot(FIT, n=1e4)

SIM <- eqsim_run(FIT,
                 Fcv=0.25, 
                 Fphi=0.30,
                 Blim=70000,
                 Bpa=150000,
                 Fscan = seq(0,1.2,len=40),
                 verbose=FALSE,
                 extreme.trim=c(0.05,0.95))
eqsim_plot(SIM,catch=TRUE)
eqsim_plot_range(SIM)
```
